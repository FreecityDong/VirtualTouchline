# 11 人制足球战术对抗数据模型与 AIGC 战术分析系统

## 统一数据模型设计文档

---

## 1. 文档目的

本文档系统性描述一套用于 **11 人制足球比赛战术对抗模拟** 的完整数据模型。  
该模型能够：

- 统一描述不同足球阵型的结构差异
- 建模阵型之间的动态克制关系
- 融合比赛策略（前压、后撤、控球、反击等）
- 在时间序列中模拟战术对抗过程
- 计算双方进球概率与预期进球（xG）
- 为 AIGC 提供**可信、可解释的战术分析输入**

本模型不依赖具体球员数据，重点刻画**阵型与战术结构本身的对抗逻辑**，适合科研、教学与科创系统实现。

---

## 2. 系统总体建模思想

### 2.1 抽象层级划分

整个模型分为五个逻辑层级：

1. **阵型结构层（Formation Layer）**
2. **战术策略层（Tactic Layer）**
3. **结构对抗层（Matchup Layer）**
4. **比赛过程层（Temporal Simulation Layer）**
5. **战术分析与解说层（AIGC Analysis Layer）**

各层职责清晰，通过标准化特征与中间指标连接，保证系统可解释、可扩展。

---

## 3. 阵型结构层（Formation Layer）

### 3.1 阵型的建模方式

阵型不被视为静态站位图，而被抽象为一组**结构特征向量**，描述其在理想执行状态下的战术倾向。  
阵型本体仅定义“结构模板”，其实际效果由策略与比赛状态动态修正。

---

### 3.2 阵型结构特征维度（8 维）

所有阵型统一由以下 8 个核心维度描述（取值范围 0~1）：

| 维度 | 含义                                   |
| ---- | -------------------------------------- |
| AW   | 进攻宽度（Attack Width）               |
| DW   | 防守宽度覆盖（Defense Width Coverage） |
| CN   | 中路人数优势倾向（Central Numbers）    |
| HS   | 肋部控制能力（Half-space Control）     |
| PR   | 逼抢基线（Pressing Baseline）          |
| BS   | 防线稳固性（Backline Security）        |
| TR   | 攻守转换速度（Transition Speed）       |
| BU   | 组织与控球能力（Build-up / Control）   |

---

### 3.3 阵型集合（当前支持）

系统当前支持并统一建模以下阵型（按风格归类）：

- **四后卫体系**
  - 4-4-2：经典平衡，双前锋。
  - 4-4-1-1：单前锋+影锋，防守时变 4-5-1。
  - 4-3-3：进攻性强，依赖边锋。
  - 4-2-3-1：现代流行，双后腰+前腰。
  - 4-1-4-1：单后腰，侧重中场控制与防守。
  - 4-3-2-1（圣诞树）：双前腰支持单前锋。
  - 4-2-2-2：双后腰，双攻击中场，双前锋（南美风格）。
  - 4-4-2 钻石：菱形中场，中路密集。

- **三后卫 / 五后卫体系**
  - 3-5-2：三中卫+双翼卫，攻守平衡。
  - 3-4-3：攻击性强，翼卫负担重。
  - 3-4-1-2：三中卫，前腰支持双前锋。
  - 5-3-2：五后卫防守稳固，反击犀利。
  - 5-4-1：极端防守阵型。

- **历史与经典阵型**
  - 2-3-5（金字塔）：最早期阵型，五前锋。
  - WM（3-2-2-3）：1920 年代革命性阵型。
  - 4-2-4：1950-60 年代巴西攻击阵型。
  - 5-3-2 链式防守：意大利风格。

- **特殊与实验阵型**
  - 4-6-0（无锋阵）：无固定前锋，西班牙曾用。
  - 4-3-3（伪九号）：中锋回撤组织。
  - 3-3-3-1：实验性，层次分明。

### 3.3.1 阵型结构特征系数表（0~1）

> 说明：数值为结构倾向系数，越高代表该维度倾向越明显。  
> 维度含义见 3.2（AW/DW/CN/HS/PR/BS/TR/BU）。

| 阵型 | AW | DW | CN | HS | PR | BS | TR | BU |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 4-4-2 | 0.65 | 0.70 | 0.55 | 0.45 | 0.55 | 0.70 | 0.70 | 0.55 |
| 4-4-1-1 | 0.62 | 0.72 | 0.60 | 0.50 | 0.55 | 0.72 | 0.65 | 0.60 |
| 4-3-3 | 0.80 | 0.62 | 0.55 | 0.55 | 0.70 | 0.55 | 0.70 | 0.62 |
| 4-2-3-1 | 0.70 | 0.70 | 0.65 | 0.60 | 0.62 | 0.70 | 0.60 | 0.70 |
| 4-1-4-1 | 0.68 | 0.72 | 0.62 | 0.55 | 0.58 | 0.74 | 0.58 | 0.62 |
| 4-3-2-1（圣诞树） | 0.55 | 0.68 | 0.75 | 0.72 | 0.60 | 0.68 | 0.55 | 0.72 |
| 4-2-2-2 | 0.58 | 0.65 | 0.70 | 0.72 | 0.62 | 0.66 | 0.62 | 0.68 |
| 4-4-2 钻石 | 0.50 | 0.60 | 0.78 | 0.70 | 0.60 | 0.65 | 0.62 | 0.70 |
| 3-5-2 | 0.70 | 0.65 | 0.70 | 0.60 | 0.60 | 0.68 | 0.62 | 0.65 |
| 3-4-3 | 0.78 | 0.55 | 0.55 | 0.60 | 0.68 | 0.55 | 0.72 | 0.58 |
| 3-4-1-2 | 0.62 | 0.60 | 0.70 | 0.65 | 0.62 | 0.62 | 0.60 | 0.68 |
| 5-3-2 | 0.55 | 0.78 | 0.62 | 0.55 | 0.45 | 0.82 | 0.60 | 0.50 |
| 5-4-1 | 0.45 | 0.82 | 0.58 | 0.48 | 0.40 | 0.85 | 0.55 | 0.45 |
| 2-3-5（金字塔） | 0.85 | 0.40 | 0.60 | 0.55 | 0.65 | 0.35 | 0.75 | 0.55 |
| WM（3-2-2-3） | 0.70 | 0.55 | 0.60 | 0.55 | 0.55 | 0.55 | 0.65 | 0.55 |
| 4-2-4 | 0.82 | 0.50 | 0.55 | 0.55 | 0.60 | 0.50 | 0.75 | 0.52 |
| 5-3-2 链式防守 | 0.50 | 0.85 | 0.60 | 0.50 | 0.35 | 0.90 | 0.58 | 0.45 |
| 4-6-0（无锋阵） | 0.60 | 0.70 | 0.80 | 0.75 | 0.70 | 0.60 | 0.55 | 0.78 |
| 4-3-3（伪九号） | 0.75 | 0.60 | 0.65 | 0.70 | 0.70 | 0.55 | 0.68 | 0.75 |
| 3-3-3-1 | 0.68 | 0.58 | 0.70 | 0.65 | 0.65 | 0.58 | 0.65 | 0.65 |

每个阵型均配有：

- 完整的 8 维结构特征值
- 一段约 20 字的**战术解说型结构说明文本**

---

### 3.4 阵型结构说明（解说员维度）

（以下文本可直接用于 AIGC 战术分析）

- **4-4-2**  
  结构均衡双前锋，反击效率高但中场易被压。

- **4-4-1-1**  
  影锋衔接更顺，防守时收缩成 4-5-1。

- **4-3-3**  
  边锋拉宽进攻强，高位压迫但身后空当大。

- **4-2-3-1**  
  双后腰稳中场，前腰串联，攻守更均衡。

- **4-1-4-1**  
  单后腰护防线，侧重中场控制与防守。

- **4-3-2-1（圣诞树）**  
  双前腰支援中锋，中路密集但边路弱。

- **4-2-2-2**  
  双后腰双前腰，肋部渗透强但阵型偏窄。

- **4-4-2 钻石**  
  菱形中场控中路，边路宽度与覆盖不足。

- **3-5-2**  
  三中卫配翼卫，控中场强，攻守更均衡。

- **3-4-3**  
  三前锋压迫强，宽度大但防线风险高。

- **3-4-1-2**  
  三中卫稳守，前腰支援双前锋，衔接清晰。

- **5-3-2**  
  五后卫厚防线，反击直接，但进攻投入较少。

- **5-4-1**  
  极端防守取向，低位密集，主要依赖反击。

- **2-3-5（金字塔）**  
  经典金字塔，五前锋火力强但防线薄弱。

- **WM（3-2-2-3）**  
  分层清晰过渡快，历史经典但现代罕见。

- **4-2-4**  
  四前锋攻击猛烈，适合强攻但风险极高。

- **5-3-2 链式防守**  
  链式防守极稳，层次深，压缩空间打反击。

- **4-6-0（无锋阵）**  
  无锋阵控球强，跑位灵活但终结依赖配合。

- **4-3-3（伪九号）**  
  伪九回撤组织，前场流动强但禁区支点弱。

- **3-3-3-1**  
  实验性层次分明，压迫与控球相对平衡。

---

## 4. 战术策略层（Tactic Layer）

### 4.1 策略的定义

战术策略描述在既定阵型基础上的即时战术选择，用于动态修正阵型结构特征。  
每个策略由 **类型** 与 **强度系数** 组成，强度取值 `0~1`，用于缩放策略影响。

常见策略类型（成对互斥或择一）：

- 前压 / 后撤
- 高位逼抢 / 深度防守
- 控球推进 / 快速反击
- 边路倾斜 / 中路渗透

---

### 4.2 策略影响方式

策略通过以下方式影响模型（数值化规则）：

- 对阵型特征（AW/DW/CN/HS/PR/BS/TR/BU）进行加减修正
- 引入 **Risk（风险系数）**，刻画前压程度与身后空间暴露风险

**数值化公式：**

```
Feature' = clamp(Feature + α * ΔFeature, 0, 1)
Risk'    = clamp(Risk + α * ΔRisk, 0, 1)
```

其中：
- `α` 为策略强度（0~1）
- `ΔFeature` 为策略的基准偏移量（见 4.3）
- `clamp` 用于限制特征在 `0~1` 区间

策略可高频切换，阵型切换频率相对较低。

---

### 4.3 常见策略与数字化影响（基准系数）

> 说明：下表为策略“强度 α=1”时的基准偏移量。  
> 实际应用时按公式缩放（α<1）。

| 策略 | 简述 | ΔAW | ΔDW | ΔCN | ΔHS | ΔPR | ΔBS | ΔTR | ΔBU | ΔRisk |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 前压 | 防线前移，压缩对手出球空间 | +0.05 | -0.05 | +0.05 | +0.05 | +0.12 | -0.08 | +0.05 | -0.02 | +0.12 |
| 后撤 | 降低阵型高度，收缩防守 | -0.05 | +0.08 | +0.02 | -0.02 | -0.10 | +0.12 | -0.05 | -0.02 | -0.10 |
| 高位逼抢 | 前场高压，制造失误 | +0.03 | -0.03 | +0.02 | +0.02 | +0.20 | -0.10 | +0.05 | -0.05 | +0.15 |
| 深度防守 | 低位密集，守转反击 | -0.05 | +0.10 | +0.03 | -0.03 | -0.18 | +0.15 | -0.05 | -0.05 | -0.12 |
| 控球推进 | 以控球与组织为主 | -0.02 | +0.03 | +0.08 | +0.06 | -0.02 | +0.02 | -0.08 | +0.18 | -0.03 |
| 快速反击 | 以纵向推进与直塞为主 | +0.05 | -0.02 | -0.02 | -0.02 | +0.05 | -0.05 | +0.18 | -0.08 | +0.06 |
| 边路倾斜 | 进攻重心放在两翼 | +0.18 | +0.02 | -0.05 | -0.08 | +0.02 | -0.02 | +0.05 | -0.02 | +0.03 |
| 中路渗透 | 进攻重心压向中路与肋部 | -0.08 | -0.02 | +0.15 | +0.12 | +0.02 | -0.02 | +0.02 | +0.05 | +0.04 |

---

### 4.4 策略组合规则（建议）

- 同一对互斥策略仅可选择其一（如“前压”或“后撤”）。
- 每个时间片建议最多叠加 2~3 个策略，避免数值过度偏移。
- 若叠加多策略，按加权平均或线性叠加后再 `clamp`。

---

### 4.5 强度分级机制（语音 → LLM 判定）

策略强度由语音中的“程度词/语气”经 LLM 解析后得到，统一输出 **强度等级** 与 **α 系数**。

**流程：**
1. ASR 获取文本
2. LLM 解析意图 → `{strategy, intensity_level, confidence}`
3. 由强度等级映射为 `α`
4. 结合策略偏移量线性叠加并 `clamp`

**强度分级与 α 映射：**

| 强度等级 | 典型表述 | α |
| --- | --- | --- |
| 轻微 | “稍微/轻一点/保守一点” | 0.3 |
| 适中 | “正常/标准/适中” | 0.5 |
| 较强 | “强一点/积极一点” | 0.7 |
| 极强 | “全力/拉满/最大” | 0.9 |

**LLM 输出建议格式（示例）：**
```json
{
  "strategy": "高位逼抢",
  "intensity_level": "较强",
  "alpha": 0.7,
  "confidence": 0.82
}
```

**兜底规则：**
- 若 LLM `confidence < 0.6`，默认 `intensity_level = 适中`（α=0.5）
- 若语音无明确程度词，则使用最近一次强度或默认值

---

## 5. 结构对抗层（Matchup Layer）

### 5.1 对抗建模原则

- 不使用硬编码“阵型克制表”
- 所有克制关系由结构特征自然计算得出
- 对抗具有方向性（A→B 与 B→A 独立计算）

---

### 5.2 五个核心对抗维度（结构优势）

1. **边路对抗**：AW_A vs (DW_B + BS_B)  
2. **中场人数与控制**：(CN_A + BU_A) vs (CN_B + PR_B)  
3. **肋部渗透**：(HS_A + BU_A) vs (CN_B + BS_B)  
4. **纵深风险与反击**：Risk_A − BS_A vs TR_B  
5. **出球 vs 压迫**：BU_A vs PR_B  

以上维度反映“结构层面的优势”，用于计算 **进攻修正系数 M(A→B)**。

---

### 5.3 攻防过程建模（过程因子）

除结构优势外，还引入“进攻过程”与“防守破坏”因素，用于更真实地映射进球率。

**进攻过程分解（A 进攻 B）：**

1. **出球/组织因子** `F_build`  
   体现出球质量与对手压迫对抗。  
   `F_build = sigmoid( BU_A - PR_B )`

2. **推进因子** `F_progress`  
   体现宽度/肋部推进对防线覆盖的压制。  
   `F_progress = sigmoid( 0.6*AW_A + 0.4*HS_A - (0.6*DW_B + 0.4*BS_B) )`

3. **进入禁区因子** `F_entry`  
   体现中路人数与肋部控制对禁区渗透。  
   `F_entry = sigmoid( 0.5*CN_A + 0.5*HS_A - BS_B )`

4. **反击/纵深因子** `F_transition`  
   体现攻守转换速度与防线稳定对抗。  
   `F_transition = sigmoid( TR_A + Risk_A - BS_B )`

**防守破坏因子（B 防守 A）：**

`F_disrupt = sigmoid( PR_B + BS_B - (BU_A + TR_A) )`  
用于削弱 A 的出球与推进效率。

> 说明：`sigmoid(x) = 1 / (1 + e^{-k x})`，推荐 `k=3`。  
> 结果范围 0~1，数值越高代表该过程越有效。

---

### 5.4 对抗修正系数与进球率映射

**进攻修正系数：**

```
M(A→B) = clamp(0.7 + 0.6 * Σ w_i * advantage_i, 0.4, 1.4)
```

其中 `advantage_i` 来自 5.2 的结构对抗差值（标准化后），`w_i` 为权重（建议总和=1）。

**射门概率（时间片内 P_shot）与进球率 λ：**

```
ShotRate = BaseShots * (0.4*F_build + 0.4*F_progress + 0.2*F_transition) * (1 - F_disrupt)
ShotProb = 1 - exp(-ShotRate * Δt)
ShotQuality = BaseXG * (0.6*F_entry + 0.4*F_progress)
λ(A→B) = ShotRate * ShotQuality * M(A→B)
```

- `BaseShots` 为基础射门频率（按 90 分钟或单时间片标定）  
- `Δt` 为时间片长度占整场比例（如 5 分钟 = 5/90）  
- `BaseXG` 为单次射门基础 xG

> 先计算“射门概率”，再由射门质量与修正系数得到进球率。  
> 该映射显式考虑“出球→推进→进入禁区→射门→进球率”的过程。

---

### 5.5 双向对抗与状态更新

在同一时间片内，同时计算 `λ(A→B)` 与 `λ(B→A)`，并可由以下因素动态修正：

- **比分压力**：落后方可额外提升 `TR` 或 `PR`
- **体能/疲劳**：疲劳上升降低 `PR、TR`，提高 `Risk`
- **连续压制**：若一方连续时间片占优，提升其 `BU`、降低对手 `PR`

该层输出作为 6.2 的输入，进入时间片模拟与进球概率计算。

---

### 5.6 球场分区与进攻链路推演（过程解说依据）

为体现“从中场开球逐步推进到进球”的过程，结构对抗层引入**球场分区状态机**，对球的位置与进攻阶段进行推演，并纳入**进攻路线（左/中/右）**。

**球场分区（推荐 9 区，含左右侧）：**

1. **后场左/中/右**（DZ_L / DZ_C / DZ_R）  
2. **中场左/中/右**（MC_L / MC_C / MC_R）  
3. **前场左/中/右**（AT_L / AT_C / AT_R）  
4. **禁区左/中/右威胁区**（BA_L / BA_C / BA_R）  
5. **禁区内射门区**（PA）

> 若需简化，可回退为 6 区模型；若需更细，可扩展为 12 区（含半空间与边线区）。

---

### 5.7 区域对抗计算与转移概率（含进攻路线）

每个区域定义一组“对抗因子”，用于计算**区域推进概率**，并在三条进攻路线中择优：

```
Z_adv = w1*AW + w2*HS + w3*CN + w4*BU - w5*DW - w6*BS - w7*PR
P_advance = sigmoid(Z_adv)
P_loss = sigmoid(PR_B + BS_B - (BU_A + TR_A))
P_shot = sigmoid(0.6*F_entry + 0.4*F_progress)  (仅在 BA/PA 区域生效)
```

**路线权重（Left/Center/Right）**：

```
W_left   = sigmoid( 0.7*AW + 0.3*HS - 0.6*DW_B_left )
W_center = sigmoid( 0.6*CN + 0.4*HS - 0.6*CN_B )
W_right  = sigmoid( 0.7*AW + 0.3*HS - 0.6*DW_B_right )
```

> 说明：`DW_B_left / DW_B_right` 可由 6.6 的区域防守映射计算得到，  
> 如取 `C_defense(MC_L/AT_L)` 与 `C_defense(MC_R/AT_R)` 的加权平均。

归一化：`W_left + W_center + W_right = 1`  
最终推进概率：`P_advance_route = P_advance * W_route`

**区域转移（从区 i 到区 i+1 或同层横向切换）：**

```
State_i(L/C/R) -> State_{i+1}(L/C/R)  with P_advance_route
State_i(L)     -> State_i(C)          with P_switch (横向转移)
State_i -> Turnover                    with P_loss
State_i -> Shot                        with P_shot
```

**横向转移概率（换边/转移）**：

```
P_switch = sigmoid( 0.5*BU + 0.5*HS - 0.5*PR_B )
```

此过程允许形成“进攻链路”：

`开球 -> DZ_(L/C/R) -> MC_(L/C/R) -> AT_(L/C/R) -> BA_(L/C/R) -> PA -> Shot -> Goal/Save/Block`

---

### 5.7.1 路线倾向矩阵（阵型绑定）

> 说明：路线倾向用于初始化 `W_left / W_center / W_right` 的先验权重，  
> 与实时对抗权重相乘后再归一化，体现阵型的天然路线偏好。

| 阵型 | 左路 | 中路 | 右路 | 路线倾向说明 |
| --- | --- | --- | --- | --- |
| 4-4-2 | 0.35 | 0.30 | 0.35 | 两翼均衡，双前锋接应 |
| 4-4-1-1 | 0.34 | 0.32 | 0.34 | 边中均衡，影锋穿插 |
| 4-3-3 | 0.40 | 0.20 | 0.40 | 边锋主导，左右路强 |
| 4-2-3-1 | 0.32 | 0.36 | 0.32 | 前腰串联，中路更重 |
| 4-1-4-1 | 0.33 | 0.34 | 0.33 | 中路控制，边路辅助 |
| 4-3-2-1（圣诞树） | 0.26 | 0.48 | 0.26 | 中路密集，肋部渗透 |
| 4-2-2-2 | 0.30 | 0.40 | 0.30 | 肋部集中，中路偏强 |
| 4-4-2 钻石 | 0.22 | 0.56 | 0.22 | 菱形中场，极度中路 |
| 3-5-2 | 0.35 | 0.30 | 0.35 | 翼卫驱动，边路并重 |
| 3-4-3 | 0.38 | 0.24 | 0.38 | 宽度极大，边路压制 |
| 3-4-1-2 | 0.30 | 0.40 | 0.30 | 前腰支撑，中路优势 |
| 5-3-2 | 0.30 | 0.40 | 0.30 | 反击偏中，边路补充 |
| 5-4-1 | 0.28 | 0.44 | 0.28 | 低位稳守，中路集中 |
| 2-3-5（金字塔） | 0.36 | 0.28 | 0.36 | 两翼与内锋协同 |
| WM（3-2-2-3） | 0.34 | 0.32 | 0.34 | 结构均衡，路线均衡 |
| 4-2-4 | 0.38 | 0.24 | 0.38 | 边锋压上，边路优先 |
| 5-3-2 链式防守 | 0.28 | 0.44 | 0.28 | 压缩中路，反击中路 |
| 4-6-0（无锋阵） | 0.30 | 0.40 | 0.30 | 中路控球，无锋渗透 |
| 4-3-3（伪九号） | 0.36 | 0.28 | 0.36 | 宽度保持，伪九回撤 |
| 3-3-3-1 | 0.33 | 0.34 | 0.33 | 三线平衡，路线均衡 |

---

### 5.8 进攻链路到解说的映射

每次成功推进或失败对抗都可生成解说事件：

- **推进成功**：  
  “中场完成出球，球队顺利进入前场推进区。”
- **被压制失误**：  
  “对手逼抢成功，球权发生转换。”
- **进入禁区**：  
  “肋部渗透到位，形成禁区威胁。”
- **射门产生**：  
  “在禁区内完成射门，门前机会出现。”

可增加“路线型解说”：

- **左路推进**：  
  “左路连续推进，边路形成压制。”
- **中路渗透**：  
  “中路配合打穿防线，形成威胁。”
- **右路转移**：  
  “长传转移右路，拉开防守宽度。”

该结构为后续 AIGC 过程解说提供明确的因果链条与事件触发依据。

---

## 6. 整体数学模型（阵型 × 策略 × 结构对抗 × 过程）

> 本节将阵型、策略、结构对抗与进攻过程统一到一套可计算的数学框架中，  
> 用于时间片级的仿真与解说生成。

### 6.1 模型变量与符号

**阵型向量（8 维）**：  
`F = [AW, DW, CN, HS, PR, BS, TR, BU] ∈ [0,1]^8`

**策略集合（时间片内）**：  
`S = { (s_i, α_i) }`，其中 `α_i∈[0,1]`

**风险系数**：  
`Risk ∈ [0,1]`

**路线倾向先验**：  
`W_form = [W_L, W_C, W_R]`（来自 5.7.1）

---

### 6.2 阵型与策略融合

**策略偏移叠加：**

```
ΔF = Σ (α_i * ΔF_i)
F' = clamp(F + ΔF, 0, 1)
Risk' = clamp(Risk + Σ (α_i * ΔRisk_i), 0, 1)
```

`ΔF_i` 与 `ΔRisk_i` 来自 4.3 的策略表。

---

### 6.3 结构对抗优势（A 进攻 B）

**结构对抗差值（标准化）：**

```
adv_1 = AW_A' - (DW_B' + BS_B')/2
adv_2 = (CN_A' + BU_A')/2 - (CN_B' + PR_B')/2
adv_3 = (HS_A' + BU_A')/2 - (CN_B' + BS_B')/2
adv_4 = (Risk_A' - BS_A') - TR_B'
adv_5 = BU_A' - PR_B'
```

**结构修正系数：**

```
M(A→B) = clamp(0.7 + 0.6 * Σ w_i * adv_i, 0.4, 1.4)
```

`w_i` 为权重，建议总和=1。

---

### 6.4 进攻过程因子

```
F_build      = sigmoid(BU_A' - PR_B')
F_progress   = sigmoid(0.6*AW_A' + 0.4*HS_A' - (0.6*DW_B' + 0.4*BS_B'))
F_entry      = sigmoid(0.5*CN_A' + 0.5*HS_A' - BS_B')
F_transition = sigmoid(TR_A' + Risk_A' - BS_B')
F_disrupt    = sigmoid(PR_B' + BS_B' - (BU_A' + TR_A'))
```

`sigmoid(x) = 1 / (1 + e^{-k x})`，推荐 `k=3`。

---

### 6.5 路线权重与区域推进

**路线先验融合：**

```
W_route_raw = W_form ⊙ [W_left, W_center, W_right]
W_route = normalize(W_route_raw)
```

**区域推进概率（每条路线）：**

```
P_advance_route = P_advance * W_route
P_loss = sigmoid(PR_B' + BS_B' - (BU_A' + TR_A'))
P_shot = sigmoid(0.6*F_entry + 0.4*F_progress)   (仅 BA/PA)
```

由此构建“开球→推进→进入禁区→射门”的路径状态机（见 5.7）。

---

### 6.6 区域进攻/防守能力映射（阵型 → 9 区）

为区分同一阵型在不同区域的能力，将 8 维结构特征映射到 9 个区域的**进攻控制指数**与**防守控制指数**。

**基本形式：**

```
C_attack(zone) = sigmoid( W_attack(zone) · F' )
C_defense(zone) = sigmoid( W_defense(zone) · F' )
```

其中 `F'` 为策略修正后的阵型特征向量，`W_attack / W_defense` 为区域权重向量。

**进攻控制指数权重（W_attack）示例：**

| 区域 | AW | DW | CN | HS | PR | BS | TR | BU |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| DZ_L | 0.10 | 0.00 | 0.10 | 0.10 | 0.00 | 0.00 | 0.05 | 0.25 |
| DZ_C | 0.05 | 0.00 | 0.15 | 0.15 | 0.00 | 0.00 | 0.05 | 0.30 |
| DZ_R | 0.10 | 0.00 | 0.10 | 0.10 | 0.00 | 0.00 | 0.05 | 0.25 |
| MC_L | 0.20 | 0.00 | 0.10 | 0.15 | 0.00 | 0.00 | 0.10 | 0.20 |
| MC_C | 0.10 | 0.00 | 0.25 | 0.25 | 0.00 | 0.00 | 0.05 | 0.15 |
| MC_R | 0.20 | 0.00 | 0.10 | 0.15 | 0.00 | 0.00 | 0.10 | 0.20 |
| AT_L | 0.30 | 0.00 | 0.10 | 0.20 | 0.00 | 0.00 | 0.10 | 0.10 |
| AT_C | 0.10 | 0.00 | 0.30 | 0.30 | 0.00 | 0.00 | 0.10 | 0.05 |
| AT_R | 0.30 | 0.00 | 0.10 | 0.20 | 0.00 | 0.00 | 0.10 | 0.10 |

**防守控制指数权重（W_defense）示例：**

| 区域 | AW | DW | CN | HS | PR | BS | TR | BU |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| DZ_L | 0.00 | 0.10 | 0.05 | 0.00 | 0.10 | 0.25 | 0.05 | 0.00 |
| DZ_C | 0.00 | 0.05 | 0.10 | 0.00 | 0.15 | 0.30 | 0.05 | 0.00 |
| DZ_R | 0.00 | 0.10 | 0.05 | 0.00 | 0.10 | 0.25 | 0.05 | 0.00 |
| MC_L | 0.00 | 0.20 | 0.10 | 0.00 | 0.20 | 0.15 | 0.10 | 0.00 |
| MC_C | 0.00 | 0.10 | 0.15 | 0.00 | 0.25 | 0.20 | 0.15 | 0.00 |
| MC_R | 0.00 | 0.20 | 0.10 | 0.00 | 0.20 | 0.15 | 0.10 | 0.00 |
| AT_L | 0.00 | 0.25 | 0.05 | 0.00 | 0.20 | 0.15 | 0.10 | 0.00 |
| AT_C | 0.00 | 0.10 | 0.10 | 0.00 | 0.25 | 0.20 | 0.10 | 0.00 |
| AT_R | 0.00 | 0.25 | 0.05 | 0.00 | 0.20 | 0.15 | 0.10 | 0.00 |

**区域对抗强度：**

```
Z_zone = C_attack_A(zone) - C_defense_B(zone)
P_win_zone = sigmoid(Z_zone)
```

> 不同阵型通过 `F'` 的差异体现不同区域倾向，  
> 例如 AW/HS 高的阵型在 AT_L/AT_R 区域更强，CN/BU 高的阵型在 MC_C/AT_C 更强。

---

### 6.7 射门概率与进球率

```
ShotRate    = BaseShots * (0.4*F_build + 0.4*F_progress + 0.2*F_transition) * (1 - F_disrupt)
ShotProb    = 1 - exp(-ShotRate * Δt)
ShotQuality = BaseXG * (0.6*F_entry + 0.4*F_progress)
λ(A→B)      = ShotRate * ShotQuality * M(A→B)
```

**解释：**
- `ShotProb` 为时间片内“至少一次射门”的概率
- `λ` 为时间片内进球率（用于泊松或蒙特卡洛）
- `BaseShots/BaseXG/Δt` 需按时间片长度统一标定，确保跨时间片可比

---

### 6.7 单时间片统一流程（可实现）

1. 读取阵型与策略 `F_A, F_B, S_A, S_B`
2. 计算 `F_A', F_B', Risk_A', Risk_B'`
3. 计算结构优势 `adv_i` 与 `M(A→B), M(B→A)`
4. 计算过程因子 `F_build ... F_disrupt`
5. 计算路线权重 `W_route` 并进行区域转移
6. 计算 `ShotProb` 与 `λ`
7. 输出：进球率、区域状态、解说事件

---

### 6.8 球权与区域状态机（文字定义）

**状态定义：**
- **球权状态** `P ∈ {A, B}`  
- **区域状态** `Z ∈ {DZ_L, DZ_C, DZ_R, MC_L, MC_C, MC_R, AT_L, AT_C, AT_R, BA_L, BA_C, BA_R, PA}`  
  （其中 BA 为禁区威胁区，PA 为禁区内射门区）
- **时间片状态** `T_k = (P_k, Z_k)`

**状态转移逻辑（文字描述）：**
1. **控球推进**：在球权不变的情况下，根据 `P_advance_route` 决定由当前区域进入下一纵深区域（同侧或同中路）。  
2. **横向转移**：在球权不变情况下，根据 `P_switch` 在同一纵深层内左右或中路切换，以反映转移与拉扯防线。  
3. **失误/被抢断**：根据 `P_loss` 触发球权交换，区域通常回到对方的中场或后场起始区（如 `MC_C` 或 `DZ_C`），体现反抢或断球后的重新组织。  
4. **射门事件**：当处于 `BA` 或 `PA` 区域并触发 `P_shot`，进入射门结果判定（进球/被扑/被封堵）。  
5. **射门后的球权变化**：
   - 进球：球权交给对方，区域回到开球区（`MC_C`）。
   - 被扑/被解围：球权可能保持或切换，区域回到 `AT` 或 `MC` 区域。

**概率守恒约束：**
- 对任意区域，需满足  
  `P_advance + P_switch + P_shot + P_loss ≤ 1`  
  其余部分定义为 `P_hold`（控球停留）。

**攻防转换规则：**
- 一旦发生球权切换，需立即重算 `F'、Risk'、M` 以及区域对抗概率。  
- 可设置“转换窗口”（1 个时间片）使反击侧 `TR` 与 `Risk` 获得短时加成。

---

### 6.9 射门结果概率分解（进球 / 扑救 / 封堵）

当触发射门事件后，将“射门质量”与“防守反应”拆解为三类结果概率：

1. **进球概率** `P_goal`
2. **扑救概率** `P_save`
3. **封堵概率** `P_block`

**基础变量：**

- 射门质量：`ShotQuality`（见 6.7）  
- 防守反应：`DefReaction = 0.5*BS_B + 0.5*PR_B`  
- 门将影响（可选）：`GK = GK_reflex`（默认 0.5）

**射门类型（ShotType）影响：**

设定扩展射门类型：
- **远射**（Long）：距离远、质量低、封堵概率高  
- **禁区内射门**（Box）：质量中等、扑救压力大  
- **单刀/绝佳机会**（BigChance）：质量高、进球概率高  
- **头球**（Header）：受传中质量影响，门将反应偏慢  
- **定位球**（SetPiece）：质量稳定，防守反应可控  
- **凌空/半凌空**（Volley）：质量高但不稳定  
- **低射/推射**（Placed）：质量高，门将反应难度大  
- **远角兜射**（Curled）：质量高，但封堵概率较高  
- **点球**（Penalty）：高转化率、门将反应为主  
- **近距离补射**（Rebound）：距离近、反应时间短  
- **爆射/抽射**（Power）：力量大但可预判  
- **倒钩**（Bicycle）：极端技术动作，命中率不稳  
- **挑射/吊射**（Chip）：门将出击时有效，成功率不稳  
- **脚后跟**（Backheel）：意外性强但命中率较低  
- **远距离任意球**（LongFK）：距离远，质量不稳  
- **近距离任意球**（ShortFK）：质量较高，组织性强  
- **角球直接射门**（CornerShot）：意外性强，成功率低  
- **贴地斜射**（LowDrive）：速度快贴地，门将反应难  
- **外脚背**（OutsideFoot）：弧线诡异但稳定性偏低  
- **搓射**（Finesse）：强调角度与弧线，质量中高  
- **门前捅射**（Poke）：距离近但发力不足  
- **近点头球**（NearPostHeader）：时机好则威胁大  
- **后点头球**（FarPostHeader）：角度刁钻但难度高  
- **世界波**（Screamer）：质量极高但发生频率低  
- **贴门柱射门**（NearPostShot）：角度小但门将反应难  
- **远距离吊门**（LongChip）：门将站位靠前时有效  
- **脚内侧推远角**（InsideCurl）：角度刁钻，成功率较高  
- **单刀挑射**（OneOnOneChip）：面对门将，风险收益高  
- **一脚爆杆**（FirstTimePower）：节奏快但精度不稳  
- **凌空侧勾**（ScissorVolley）：动作难度高，命中率不稳  
- **倒地扫射**（SlidingShot）：抢点快但发力受限  
- **贴地远角**（LowFarPost）：角度刁钻，门将反应难  
- **门前补刀**（TapIn）：距离极近，成功率高  
- **禁区外贴地直塞射**（SkiddingDrive）：贴地速度快，封堵难  
- **半凌空**（HalfVolley）：时机要求高，质量中等  
- **电梯球任意球**（KnuckleFK）：轨迹诡异，稳定性一般  
- **弧线任意球**（CurledFK）：弧线精准，质量较高  
- **倒三角回做射门**（CutBack）：接应轻松，成功率高  
- **二过一配合射门**（OneTwoFinish）：节奏快，防守难跟  
- **反越位单刀推射**（ThroughBallFinish）：机会大，但处理压力高  
- **反击高速射门**（CounterFinish）：节奏快，门将站位难调  
- **远距离直线爆射**（DrivenShot）：球速快，门将反应难  
- **无角度小角度射门**（TightAngle）：角度小，进球难度高  
- **脚内侧轻推近角**（InsideNearPost）：距离近，门将易被晃  
- **胸部停球后射门**（ChestControlShot）：衔接流畅但成功率一般  

引入类型修正项：

```
ShotQuality' = ShotQuality + TypeBonus
DefReaction' = DefReaction + TypeDefense
```

建议类型参数（示例）：

| 射门类型 | TypeBonus | TypeDefense |
| --- | --- | --- |
| Long | -0.08 | +0.05 |
| Box | 0.00 | 0.00 |
| BigChance | +0.12 | -0.05 |
| Header | -0.02 | -0.02 |
| SetPiece | +0.05 | +0.00 |
| Volley | +0.04 | +0.02 |
| Placed | +0.08 | -0.03 |
| Curled | +0.06 | +0.03 |
| Penalty | +0.18 | -0.10 |
| Rebound | +0.10 | -0.05 |
| Power | +0.02 | +0.04 |
| Bicycle | +0.00 | +0.06 |
| Chip | +0.06 | -0.02 |
| Backheel | -0.02 | +0.05 |
| LongFK | +0.02 | +0.06 |
| ShortFK | +0.06 | +0.02 |
| CornerShot | -0.04 | +0.06 |
| LowDrive | +0.07 | -0.03 |
| OutsideFoot | +0.03 | +0.02 |
| Finesse | +0.06 | +0.02 |
| Poke | +0.04 | -0.01 |
| NearPostHeader | +0.02 | -0.02 |
| FarPostHeader | +0.01 | +0.00 |
| Screamer | +0.10 | +0.08 |
| NearPostShot | +0.05 | -0.01 |
| LongChip | +0.03 | +0.03 |
| InsideCurl | +0.07 | -0.02 |
| OneOnOneChip | +0.09 | -0.04 |
| FirstTimePower | +0.05 | +0.04 |
| ScissorVolley | +0.03 | +0.06 |
| SlidingShot | +0.04 | +0.02 |
| LowFarPost | +0.06 | -0.02 |
| TapIn | +0.14 | -0.06 |
| SkiddingDrive | +0.05 | +0.01 |
| HalfVolley | +0.03 | +0.02 |
| KnuckleFK | +0.04 | +0.05 |
| CurledFK | +0.06 | +0.02 |
| CutBack | +0.10 | -0.04 |
| OneTwoFinish | +0.08 | -0.03 |
| ThroughBallFinish | +0.09 | -0.03 |
| CounterFinish | +0.07 | -0.02 |
| DrivenShot | +0.06 | +0.03 |
| TightAngle | -0.03 | +0.05 |
| InsideNearPost | +0.06 | -0.02 |
| ChestControlShot | +0.02 | +0.02 |

**分解示例：**

```
P_goal_raw  = sigmoid( 1.2*ShotQuality' - 0.8*DefReaction' )
P_block_raw = sigmoid( 0.6*PR_B + 0.4*BS_B - 0.6*HS_A )
P_save_raw  = sigmoid( 0.7*BS_B + 0.6*GK - 0.5*ShotQuality' )
```

**归一化：**

```
S = P_goal_raw + P_block_raw + P_save_raw
P_goal  = P_goal_raw / S
P_block = P_block_raw / S
P_save  = P_save_raw / S
```

**结果与球权流转（文字约束）：**

- **进球**：球权交给对方，区域回到开球区 `MC_C`。  
- **扑救**：球权倾向守方，区域回到 `AT` 或 `MC`（视解围距离而定）。  
- **封堵**：球权 50% 维持进攻方（形成二次进攻），50% 交给防守方。  

> 说明：该分解用于增强解说与过程仿真的细节，可根据数据校准系数。

---

### 6.10 比赛事件机制（出界 / 角球 / 任意球 / 点球 / 犯规）

为保证比赛过程完整性，在时间片状态机中引入“事件触发器”，在区域对抗与射门事件之外，模拟常见规则事件。

**核心事件类型：**

1. **出界（Throw-in）**  
   - 触发：边路区域发生 `P_loss`，且球向边线逸出  
   - 效果：球权归防守方，球回到对应边线区域（`MC_L/MC_R` 或 `AT_L/AT_R`）

2. **角球（Corner）**  
   - 触发：进攻方在 `BA_L/BA_R` 或 `PA` 射门被封堵/解围出底线  
   - 效果：进攻方获得角球，球回到 `BA_L/BA_R`

3. **任意球（Free Kick）**  
   - 触发：对抗过程中出现犯规（见下）  
   - 效果：球权归进攻方，位置保留或前移一个区域（如 `MC → AT`）

4. **点球（Penalty）**  
   - 触发：在 `PA` 区域内犯规  
   - 效果：进入点球专项结算（`ShotType = Penalty`），跳过常规推进链路

5. **犯规（Foul）**  
   - 触发：高压或对抗时机  
   - 概率模型：  
     `P_foul = sigmoid( 0.6*PR_B + 0.4*Risk_A - 0.4*BU_A )`
   - 效果：触发任意球或点球

---

### 6.11 事件触发与区域回流规则

- **出界**：球回到边线同侧区域，攻守转换  
- **角球**：球回到 `BA_L/BA_R`，进攻方继续保持球权  
- **任意球**：球位置依据犯规发生区域决定  
- **点球**：进入点球专项结算（Penalty）  
- **犯规后攻守状态**：球权交换或保持由规则决定

> 以上事件可以触发解说事件，如“角球机会”“任意球威胁”“点球判罚”。

---

### 6.12 事件优先级与概率闭环（状态机一致性）

为保证“新增事件”与“区域推进/射门”在同一状态机中兼容，需引入统一的事件优先级与概率闭环规则。

**事件优先级（同一时间片）：**

1. **犯规（Foul）** → 任意球 / 点球  
2. **射门事件（Shot）**  
3. **出界（Out）/角球（Corner）**  
4. **区域推进/横向转移/失误**  
5. **原地控球（Hold）**

> 说明：当高优先级事件触发时，低优先级事件不再发生。

**概率闭环（总和约束）：**

```
P_event = P_foul + P_shot + P_out + P_corner
P_flow  = P_advance + P_switch + P_loss
P_hold  = 1 - P_event - P_flow
```

要求：`P_event + P_flow ≤ 1`，否则按比例缩放低优先级项。  
执行顺序建议：**先分配 `P_event`，再用剩余概率分配 `P_flow`**。

---

### 6.13 区域回流统一入口

为避免事件回流逻辑分散，所有事件调用统一的“区域回流函数”：

```
Z_next = ResetZone(event, current_zone, possession)
```

**规则说明（文字版）：**
- **角球**：`BA_L/BA_R`  
- **出界**：同侧 `MC_L/MC_R` 或 `AT_L/AT_R`  
- **任意球**：保留原区域或前移一层（`MC → AT`）  
- **点球**：`PA` 并直接进入射门结算  
- **进球**：`MC_C`（对方开球）

该统一入口保证状态机对事件与区域推进的兼容性与可追踪性。

---

### 6.14 点球专项规则（Penalty）

点球不走常规“区域推进 -> 射门触发”路径，而是进入专门结算分支。

**流程定义：**

1. 触发：`event = Penalty`
2. 状态重置：`(P, Z) -> (P, PA)`
3. 射门类型固定：`ShotType = Penalty`
4. 结果计算：输出 `P_goal_pen / P_save_pen / P_miss_pen`
5. 结果回流：按比赛规则更新球权与区域

**概率计算（示例）：**

```
PenTaker = clamp(0.6*BU_A + 0.4*HS_A, 0, 1)
GKPenalty = clamp(0.5*BS_B + 0.5*PR_B, 0, 1)

P_goal_raw = sigmoid(1.25*PenTaker - 0.95*GKPenalty)
P_save_raw = sigmoid(0.90*GKPenalty - 0.55*PenTaker)
P_miss_raw = 0.08

S = P_goal_raw + P_save_raw + P_miss_raw
P_goal_pen = P_goal_raw / S
P_save_pen = P_save_raw / S
P_miss_pen = P_miss_raw / S
```

**结果回流规则：**

- **进球**：球权给对方，区域回 `MC_C` 开球
- **扑救**：若门将控制球，守方球权，区域回 `DZ_C` 或 `MC_C`
- **扑救脱手/反弹**：进入 `PA/BA` 二次球争夺
- **罚失（偏出/中框后出界）**：守方球权，区域回 `DZ` 或 `MC`

> 点球作为高价值机会，其期望进球应显著高于常规射门。

---

## 7. 比赛过程层（Temporal Simulation Layer）

### 7.1 时间片建模

比赛被离散为多个时间片（如 1 分钟或 5 分钟）：

- 时间片内阵型与策略保持不变
- 时间片结束后允许策略调整
- 阵型切换低频、受比分与时间影响

### 7.1.1 阵型与策略调整规则（90 分钟制）

- **阵型调整频率**：每 15 分钟一次，并包含开场前调整。  
  具体可执行节点：`开场前`、`15'`、`30'`、`45'`、`60'`、`75'`（共 6 次）。
- **策略调整机会**：每次阵型调整后，允许 **2 次**策略调整机会。
- **策略叠加规则**：
  - 允许叠加 **2 个不互斥**的策略。
  - 若选择互斥策略（如“前压/后撤”），**直接替换**已选策略。
  - 多策略叠加采用**线性叠加**，再执行 `clamp` 限幅。

> 线性叠加示意：  
> `ΔTotal = ΔA + ΔB (+ ΔC ...)`  
> `Feature' = clamp(Feature + α * ΔTotal, 0, 1)`

---

### 7.2 单时间片计算流程（对齐整体数学模型）

1. 读取状态：`Score`、球权 `P`、区域 `Z`、双方阵型与策略  
2. 基于策略强度修正阵型特征 `F'` 与 `Risk'`  
3. 计算结构优势 `adv_i` 与修正系数 `M(A→B), M(B→A)`  
4. 计算进攻过程因子 `F_build / F_progress / F_entry / F_transition / F_disrupt`  
5. 结合路线倾向与区域映射，得到 `P_advance / P_switch / P_loss / P_shot`  
6. 计算事件概率 `P_foul / P_out / P_corner`，按事件优先级裁决  
7. 若触发射门，抽取 `ShotType`，计算 `P_goal / P_save / P_block` 并更新球权与区域  
8. 若未射门，依据推进/转移/失误更新 `P, Z`  
9. 记录事件流（推进/失误/射门/定位球）与统计量（xG/射门数）

---

### 7.3 进球概率建模（含射门概率）

- 基于 `ShotProb` 与 `λ` 进行射门与进球采样  
- 时间片内先判定是否发生射门，再判定射门结果  
- 全场通过累积或蒙特卡洛模拟得到比分分布

---

## 8. AIGC 战术分析层（Analysis Layer）

### 8.1 AIGC 的定位

AIGC 不参与数值决策，仅基于模型输出生成**战术解释文本**，并为观众提供**过程解说**与**结构化复盘**。

---

### 8.2 AIGC 的输入

- 当前时间片阵型与策略  
- 五维对抗优势分解  
- 进攻修正系数 M  
- 进球概率 / xG  
- 区域状态与球权（Z / P）  
- 事件流（推进、失误、角球、任意球、射门结果）  
- 射门类型与结果（见 6.9）

---

### 8.3 需要加入 AIGC 文本的层面（建议）

1. **结构层（阵型/策略）**  
   - 说明阵型结构倾向与策略目的  
   - 例：“4-3-3 强调边路宽度，高位逼抢压迫出球。”

2. **对抗层（优势与风险）**  
   - 解释优势来源（边路/中路/肋部）  
   - 说明风险（身后空间、反击隐患）

3. **过程层（区域推进）**  
   - 逐段解说球的区域推进与对抗结果  
   - 例：“中场控球成功，向左路推进形成压制。”

4. **事件层（定位球与犯规）**  
   - 对角球、任意球、点球、犯规进行简短说明  
   - 例：“禁区内犯规，点球判罚。”

5. **射门层（射门类型与结果）**  
   - 描述射门方式与结果  
   - 例：“一脚低射远角，门将扑救成功。”

6. **赛后复盘层（总结）**  
   - 总结关键策略、区域优势、得失球来源  
   - 输出结构化复盘要点

---

### 8.4 AIGC 输出结构（建议）

标准输出包含：

1. 态势概括  
2. 优势来源分析  
3. 风险提示  
4. 战术调整建议  
5. 数据引用总结  
6. 关键事件回顾（角球/点球/射门）

所有输出必须可回溯到模型数据，禁止虚构球员或事件。

---

## 9. 模型整体特性

- 高可解释性
- 高扩展性
- 工程可实现
- 天然适配战术解说与 AIGC 分析

---

## 10. 总结

本文档完整定义了一套：

**以阵型结构为核心、以对抗维度为桥梁、以概率模型为输出、以 AIGC 为解释层**

的 11 人制足球战术对抗数据模型，可直接用于仿真系统、科研分析与战术解说生成。
